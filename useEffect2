// ------------------ FIXED Outside Click Handler (same logic as your working file) ------------------
useEffect(() => {
  const handleClickOutside = (event: MouseEvent) => {
    const target = event.target as HTMLElement | null;

    // 1️⃣ Click inside Inline AI Prompt → DO NOT CLOSE
    if (
      target?.closest(".k-inline-ai") ||
      target?.closest(".k-inline-ai-prompt") ||
      target?.closest(".k-popup")
    ) {
      clickedInsideRef.current = true;
      return;
    }

    // 2️⃣ Click inside Kendo Editor → DO NOT CLOSE
    const editorDom = textAreaRef.current?.view?.dom;
    if (editorDom && editorDom.contains(target)) {
      return;
    }

    // 3️⃣ Click outside → CLOSE PROMPT
    setShowPrompt(false);
    setSelectedText("");
    setOutputs([]);
    setAnchorEl(undefined);
  };

  document.addEventListener("mousedown", handleClickOutside, true);
  return () => document.removeEventListener("mousedown", handleClickOutside, true);
}, []);
