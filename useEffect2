const handleCheckboxChange = (e: any, dataItem) => {
  const checked = e.target.checked;
  const thisId = idGetter(dataItem);

  const newSelectedState = { ...selectedState };

  // Parent
  newSelectedState[thisId] = checked;

  // Children
  if (dataItem.ChildRegulationDtls?.length) {
    dataItem.ChildRegulationDtls.forEach(child => {
      const childId = idGetter(child);
      newSelectedState[childId] = checked;
    });
  }

  setSelectedState(newSelectedState);
  setSelectedSupState(newSelectedState);
};



const processedData = useMemo(() => {
  const data = process(getSubInsertData, {
    ...dataState,
    sort: dataState?.sort?.map(s =>
      s.field === "Regulation"
        ? { ...s, field: "RegSortOrder" }
        : s
    ),
  });

  data.data = data.data.map(parent => ({
    ...parent,
    selected: !!selectedState[idGetter(parent)],
    ChildRegulationDtls: parent.ChildRegulationDtls?.map(child => ({
      ...child,
      selected: !!selectedState[idGetter(child)],
    })),
  }));

  return data;
}, [getSubInsertData, dataState, selectedState]);
