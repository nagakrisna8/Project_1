useEffect(() => {
  const handleOutsideClick = (ev: MouseEvent) => {
    const target = ev.target as HTMLElement;

    // ðŸ‘‰ 1ï¸âƒ£ Inside InlineAIPrompt? (DONâ€™T CLOSE)
    if (
      target.closest(".k-inline-ai") ||
      target.closest(".k-inline-ai-prompt") ||
      target.closest(".k-popup")
    ) {
      clickedInsideRef.current = true;
      return;
    }

    // ðŸ‘‰ 2ï¸âƒ£ Inside Kendo Editor? (DONâ€™T CLOSE)
    const editorDom = textAreaRef.current?.view?.dom;
    if (editorDom && editorDom.contains(target)) {
      return;
    }

    // ðŸ‘‰ 3ï¸âƒ£ Otherwise â†’ clicking outside â†’ close
    setShowPrompt(false);
    setOutputs([]);
    setSelectedText('');
    setAnchorEl(undefined);
  };

  document.addEventListener("mousedown", handleOutsideClick, true);
  return () => document.removeEventListener("mousedown", handleOutsideClick, true);
}, []);
